{% extends 'base.html' %} {% load role_tags %} {% block title %}Exam Officer Dashboard - RMS{% endblock %} {% block content %} <!-- Delegation Status Badges --> {% show_delegation_badges user %} <!-- Exam Officer Overview Header --> <div class="ios-card" style="background: var(--royal-blue-gradient); color: white; margin-bottom: 32px;"> <div style="display: flex; justify-content: space-between; align-items: center;"> <div> <h1 style="margin: 0 0 8px 0; font-size: 28px; font-weight: 600;">Exam Officer Dashboard</h1> <p style="margin: 0; opacity: 0.9; font-size: 16px;">{{ user.get_full_name }} - {{ faculty.name }} Faculty - {{ current_session.name }}</p> </div> <div style="text-align: right;"> <div style="background: rgba(255,255,255,0.2); padding: 12px 20px; border-radius: 12px; margin-bottom: 8px;"> <div style="font-size: 24px; font-weight: 700; margin-bottom: 4px;">{{ current_level.name }}</div> <div style="font-size: 14px; opacity: 0.9;">Current Level</div> </div> </div> </div> </div> <!-- Level Selector --> <div class="card border-0 shadow-sm mb-4"> <div class="card-body"> <div class="row align-items-center"> <div class="col-md-6"> <h5 class="card-title fw-bold text-primary mb-0">Select Academic Level</h5> <small class="text-muted">Choose level to view results for specific students</small> </div> <div class="col-md-6"> <div class="row g-2"> {% for level in levels %} <div class="col-auto"> <a href="{% url 'exam_officer_dashboard' %}?level={{ level.numeric_value }}" class="btn {% if current_level.id == level.id %}btn-primary{% else %}btn-outline-secondary{% endif %} btn-sm"> {{ level.name }} {% if level.id == current_level.id %} <span class="badge bg-light text-primary ms-1">{{ stats.pending_results }}</span> {% endif %} </a> </div> {% endfor %} <div class="col-auto"> <a href="{% url 'exam_officer_dashboard' %}?level=all" class="btn {% if show_all_levels %}btn-success{% else %}btn-outline-success{% endif %} btn-sm"> <i class="bi bi-list-ul me-1"></i>All Levels {% if show_all_levels %} <span class="badge bg-light text-success ms-1">{{ stats.pending_results }}</span> {% endif %} </a> </div> <div class="col-auto"> <a href="{% url 'exam_officer_export_csv' %}?level={{ request.GET.level|default:'all' }}" class="btn btn-outline-primary btn-sm"> <i class="bi bi-download me-1"></i>Export CSV </a> </div> </div> </div> </div> </div> </div> <!-- Quick Stats Grid --> <div class="row mb-4"> <div class="col-md-3 mb-3"> <div class="card border-0 shadow-sm"> <div class="card-body text-center"> <div class="h2 text-info fw-bold mb-1">{{ stats.total_students }}</div> <div class="text-muted">{{ current_level.name }} Students</div> </div> </div> </div> <div class="col-md-3 mb-3"> <div class="card border-0 shadow-sm"> <div class="card-body text-center"> <div class="h2 text-primary fw-bold mb-1">{{ stats.pending_results }}</div> <div class="text-muted">Pending Results</div> </div> </div> </div> <div class="col-md-3 mb-3"> <div class="card border-0 shadow-sm"> <div class="card-body text-center"> <div class="h2 text-success fw-bold mb-1">{{ stats.approved_results }}</div> <div class="text-muted">Approved Results</div> </div> </div> </div> <div class="col-md-3 mb-3"> <div class="card border-0 shadow-sm"> <div class="card-body text-center"> <div class="h2 text-warning fw-bold mb-1">{{ stats.carryover_students }}</div> <div class="text-muted">Carryover Students</div> </div> </div> </div> </div> <!-- Core Actions Section --> <div class="row mb-4"> <div class="col-12"> <div class="card border-0 shadow-sm"> <div class="card-body"> <h5 class="card-title text-primary mb-3 fw-bold">Core Actions</h5> <div class="row g-3"> <div class="col-md-3"> <a href="{% url 'exam_officer_pending_results' %}?level={{ current_level.numeric_value }}" class="btn btn-primary w-100"> <i class="bi bi-clock-history me-2"></i> <div> <div class="fw-bold">Pending Results</div> <small class="opacity-75">{{ stats.pending_results }} awaiting review</small> </div> </a> </div> <div class="col-md-3"> <a href="{% url 'exam_officer_reject_results' %}?level={{ current_level.numeric_value }}" class="btn btn-outline-danger w-100"> <i class="bi bi-x-circle me-2"></i> <div> <div class="fw-bold">Rejected Results</div> <small class="opacity-75">Manage rejections</small> </div> </a> </div> <div class="col-md-3"> <a href="{% url 'exam_officer_carryovers' %}?level={{ current_level.numeric_value }}" class="btn btn-outline-warning w-100"> <i class="bi bi-exclamation-triangle me-2"></i> <div> <div class="fw-bold">Carryovers</div> <small class="opacity-75">{{ stats.carryover_students }} students</small> </div> </a> </div> <div class="col-md-3"> <a href="{% url 'exam_officer_result_history' %}?level={{ current_level.numeric_value }}" class="btn btn-outline-secondary w-100"> <i class="bi bi-archive me-2"></i> <div> <div class="fw-bold">Result History</div> <small class="opacity-75">View processed results</small> </div> </a> </div> </div> </div> </div> </div> </div> <!-- Results Overview Section --> <div class="row mb-4"> <div class="col-12"> <div class="card border-0 shadow-sm"> <div class="card-header bg-light"> <div class="row align-items-center"> <div class="col-md-6"> <h5 class="mb-0 fw-bold text-primary"> <i class="bi bi-file-earmark-text me-2"></i>Submitted Results Overview </h5> <small class="text-muted">Results submitted by lecturers for {% if show_all_levels %}All Levels{% else %}{{ current_level.name }}{% endif %}</small> </div> <div class="col-md-6"> <div class="row g-2"> <div class="col-md-4"> <select class="form-select form-select-sm" id="departmentFilter"> <option value="">All Departments</option> {% for dept in departments %} <option value="{{ dept.id }}">{{ dept.name }}</option> {% endfor %} </select> </div> <div class="col-md-4"> <select class="form-select form-select-sm" id="courseFilter"> <option value="">All Courses</option> {% for course in courses %} <option value="{{ course.id }}">{{ course.code }}</option> {% endfor %} </select> </div> <div class="col-md-4"> <button class="btn btn-outline-secondary btn-sm w-100" onclick="clearFilters()"> <i class="bi bi-x-circle me-1"></i>Clear </button> </div> </div> </div> </div> </div> <div class="card-body"> {% if results_by_category %} <!-- Department-wise Results --> {% for dept_name, dept_data in results_by_category.items %} <div class="mb-4 department-section" data-department="{{ dept_data.department_id }}"> <div class="d-flex justify-content-between align-items-center mb-3"> <h6 class="fw-bold text-secondary mb-0"> <i class="bi bi-building me-2"></i>{{ dept_name }} </h6> <span class="badge bg-info">{{ dept_data.total_results }} result(s)</span> </div> <!-- Course-wise Results within Department --> {% for course_code, course_data in dept_data.courses.items %} <div class="card mb-3 course-section" data-course="{{ course_data.course_id }}"> <div class="card-header py-2"> <div class="row align-items-center"> <div class="col-md-8"> <div class="fw-semibold text-primary">{{ course_code }}</div> <small class="text-muted">{{ course_data.course_title }}</small> </div> <div class="col-md-4 text-end"> <span class="badge bg-warning me-2">{{ course_data.results|length }} pending</span> <a href="{% url 'exam_officer_pending_results' %}?course={{ course_data.course_id }}&level={{ current_level.numeric_value }}" class="btn btn-outline-primary btn-sm"> <i class="bi bi-eye me-1"></i>Review </a> </div> </div> </div> <div class="card-body py-2"> <div class="row"> {% for result in course_data.results|slice:":3" %} <div class="col-md-4 mb-2"> <div class="d-flex align-items-center"> <div class="me-2"> <i class="bi bi-person-circle text-muted"></i> </div> <div> <div class="small fw-semibold">{{ result.enrollment.student.matric_number }}</div> <div class="small text-muted">{{ result.enrollment.student.user.get_full_name|truncatechars:20 }}</div> </div> </div> </div> {% endfor %} {% if course_data.results|length > 3 %} <div class="col-md-4 mb-2"> <div class="text-muted small"> <i class="bi bi-three-dots me-1"></i> and {{ course_data.results|length|add:"-3" }} more student(s) </div> </div> {% endif %} </div> </div> </div> {% empty %} <div class="text-muted text-center py-3"> <i class="bi bi-inbox me-2"></i>No results submitted for this department </div> {% endfor %} </div> {% empty %} <div class="text-center py-5"> <i class="bi bi-inbox text-muted" style="font-size: 3rem;"></i> <h5 class="text-muted mt-3">No Results Submitted</h5> <p class="text-muted">No results have been submitted by lecturers for {{ current_level.name }} yet.</p> </div> {% endfor %} {% else %} <div class="text-center py-5"> <i class="bi bi-inbox text-muted" style="font-size: 3rem;"></i> <h5 class="text-muted mt-3">No Results Submitted</h5> <p class="text-muted">No results have been submitted by lecturers for {{ current_level.name }} yet.</p> </div> {% endif %} </div> </div> </div> </div> {% endblock %} <script> // Auto-refresh statistics every 30 seconds { location.reload(); }, 30000); // Filter functionality for results overview document.addEventListener('DOMContentLoaded', function() { const departmentFilter = document.getElementById('departmentFilter'); const courseFilter = document.getElementById('courseFilter'); if (departmentFilter) { departmentFilter.addEventListener('change', function() { filterResults(); }); } if (courseFilter) { courseFilter.addEventListener('change', function() { filterResults(); }); } }); function filterResults() { const departmentFilter = document.getElementById('departmentFilter'); const courseFilter = document.getElementById('courseFilter'); const selectedDepartment = departmentFilter ? departmentFilter.value : ''; const selectedCourse = courseFilter ? courseFilter.value : ''; // Show/hide department sections const departmentSections = document.querySelectorAll('.department-section'); departmentSections.forEach(section => { const departmentId = section.getAttribute('data-department'); const shouldShowDept = !selectedDepartment || departmentId === selectedDepartment; if (shouldShowDept) { section.style.display = 'block'; // Filter courses within this department const courseSections = section.querySelectorAll('.course-section'); let visibleCourses = 0; courseSections.forEach(courseSection => { const courseId = courseSection.getAttribute('data-course'); const shouldShowCourse = !selectedCourse || courseId === selectedCourse; if (shouldShowCourse) { courseSection.style.display = 'block'; visibleCourses++; } else { courseSection.style.display = 'none'; } }); // Hide department if no courses are visible if (visibleCourses === 0 && selectedCourse) { section.style.display = 'none'; } } else { section.style.display = 'none'; } }); // Show message if no results are visible const visibleSections = document.querySelectorAll('.department-section[style="display: block;"], .department-section:not([style])'); const noResultsMessage = document.getElementById('noResultsMessage'); if (visibleSections.length === 0 && (selectedDepartment || selectedCourse)) { if (!noResultsMessage) { const message = document.createElement('div'); message.id = 'noResultsMessage'; message.className = 'text-center py-5'; message.innerHTML = ` <i class="bi bi-funnel text-muted" style="font-size: 3rem;"></i> <h5 class="text-muted mt-3">No Results Match Filter</h5> <p class="text-muted">No results found for the selected filters. Try adjusting your selection.</p> `; document.querySelector('.card-body').appendChild(message); } } else if (noResultsMessage) { noResultsMessage.remove(); } } function clearFilters() { const departmentFilter = document.getElementById('departmentFilter'); const courseFilter = document.getElementById('courseFilter'); if (departmentFilter) departmentFilter.value = ''; if (courseFilter) courseFilter.value = ''; // Show all sections const allSections = document.querySelectorAll('.department-section, .course-section'); allSections.forEach(section => { section.style.display = 'block'; }); // Remove no results message const noResultsMessage = document.getElementById('noResultsMessage'); if (noResultsMessage) { noResultsMessage.remove(); } } </script> 