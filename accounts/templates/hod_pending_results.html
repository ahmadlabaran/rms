{% extends 'base.html' %} {% block title %}Pending Results - HOD{% endblock %} {% block content %} <style> :root { --ios-red: #FF3B30; --ios-blue: #007AFF; --ios-green: #34C759; --ios-orange: #FF9500; --text-primary: #1D1D1F; --text-secondary: #86868B; --text-tertiary: #C7C7CC; --surface-primary: #FFFFFF; --surface-secondary: #F2F2F7; --border-color: #D1D1D6; --border-light: #E5E5EA; --royal-blue-gradient: linear-gradient(135deg, #007AFF 0%, #FF3B30 100%); } .ios-card { background: white; border-radius: 16px; padding: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); border: 1px solid var(--border-light); margin-bottom: 20px; } .btn { padding: 10px 16px; border-radius: 8px; font-weight: 600; text-align: center; border: none; cursor: pointer; font-size: 12px; text-decoration: none; display: inline-block; min-width: 100px; } .btn-primary { background: var(--royal-blue-gradient); color: white; } .btn-success { background: var(--ios-green); color: white; } .btn-danger { background: var(--ios-red); color: white; } .btn-secondary { background: var(--surface-secondary); color: var(--text-primary); border: 1px solid var(--border-color); } .result-card { background: var(--surface-secondary); border-radius: 12px; padding: 16px; margin-bottom: 12px; border: 1px solid var(--border-light); } .result-card:hover { box-shadow: 0 4px 15px rgba(0,0,0,0.1); } .status-badge { padding: 4px 8px; border-radius: 6px; font-size: 11px; font-weight: 600; text-transform: uppercase; } .status-pending { background: rgba(255, 149, 0, 0.2); color: var(--ios-orange); } /* Mobile Responsive */ @media (max-width: 768px) { .mobile-grid { grid-template-columns: 1fr !important; gap: 12px !important; } .btn { padding: 8px 12px !important; font-size: 11px !important; min-width: 80px !important; } h1 { font-size: 24px !important; } h2 { font-size: 18px !important; } } @media (max-width: 480px) { .btn { padding: 6px 10px !important; font-size: 10px !important; min-width: 70px !important; } h1 { font-size: 20px !important; } h2 { font-size: 16px !important; } .ios-card { padding: 12px !important; } } </style> <div style="max-width: 1400px; margin: 0 auto; padding: 16px;"> <!-- Header --> <div class="ios-card" style="background: var(--royal-blue-gradient); color: white;"> <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;"> <div> <h1 style="margin: 0 0 6px 0; font-size: 28px; font-weight: 600;"> Pending Results </h1> <p style="margin: 0; opacity: 0.9; font-size: 16px;"> {{ department.name }} Department • Results awaiting your approval </p> </div> <div style="display: flex; gap: 12px;"> <a href="{% url 'hod_dashboard' %}" class="btn" style="background: rgba(255,255,255,0.2); color: white;"> ← Back to Dashboard </a> </div> </div> </div> <!-- Statistics --> <div class="mobile-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;"> <div class="ios-card" style="text-align: center; background: var(--ios-orange); color: white;"> <div style="font-size: 32px; font-weight: 700; margin-bottom: 6px;">{{ stats.pending_approval }}</div> <div style="font-size: 14px; opacity: 0.9;">Pending Approval</div> </div> <div class="ios-card" style="text-align: center; background: var(--ios-green); color: white;"> <div style="font-size: 32px; font-weight: 700; margin-bottom: 6px;">{{ stats.approved_by_hod }}</div> <div style="font-size: 14px; opacity: 0.9;">Approved by You</div> </div> <div class="ios-card" style="text-align: center; background: var(--ios-blue); color: white;"> <div style="font-size: 32px; font-weight: 700; margin-bottom: 6px;">{{ stats.submitted_to_dean }}</div> <div style="font-size: 14px; opacity: 0.9;">Sent to Dean</div> </div> <div class="ios-card" style="text-align: center; background: var(--ios-red); color: white;"> <div style="font-size: 32px; font-weight: 700; margin-bottom: 6px;">{{ stats.published }}</div> <div style="font-size: 14px; opacity: 0.9;">Published</div> </div> </div> <!-- Results by Course --> {% for course_code, course_data in results_by_course.items %} <div class="ios-card"> <h2 style="color: var(--text-primary); margin-bottom: 16px; font-size: 20px; font-weight: 700;"> {{ course_data.course.code }} - {{ course_data.course.title }} ({{ course_data.results|length }} results) </h2> {% for result in course_data.results %} <div class="result-card"> <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px; flex-wrap: wrap; gap: 8px;"> <div style="flex: 1;"> <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 4px;"> {{ result.enrollment.student.matric_number }} - {{ result.enrollment.student.user.get_full_name }} </div> <div style="color: var(--text-secondary); font-size: 12px; margin-bottom: 2px;"> Session: {{ result.enrollment.session.name }} </div> <div style="color: var(--text-tertiary); font-size: 11px;"> Submitted: {{ result.updated_at|date:"M d, Y H:i" }} </div> </div> <div style="text-align: right;"> <span class="status-badge status-pending">{{ result.get_status_display }}</span> </div> </div> <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 12px; margin-bottom: 12px; padding: 12px; background: white; border-radius: 8px;"> <div style="text-align: center;"> <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 2px;">CA Score</div> <div style="font-weight: 600; color: var(--text-primary);">{{ result.ca_score|default:"-" }}</div> </div> <div style="text-align: center;"> <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 2px;">Exam Score</div> <div style="font-weight: 600; color: var(--text-primary);">{{ result.exam_score|default:"-" }}</div> </div> <div style="text-align: center;"> <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 2px;">Total</div> <div style="font-weight: 700; color: var(--ios-blue); font-size: 16px;">{{ result.total_score }}</div> </div> <div style="text-align: center;"> <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 2px;">Grade</div> <div style="font-weight: 700; color: var(--ios-green); font-size: 16px;">{{ result.grade }}</div> </div> </div> <div style="display: flex; gap: 8px; justify-content: flex-end; flex-wrap: wrap;"> <a href="{% url 'hod_review_single_result' result.id %}" class="btn btn-secondary"> View Details </a> <button class="btn btn-success approve-result-btn" data-result-id="{{ result.id }}" data-matric-number="{{ result.enrollment.student.matric_number }}"> Quick Approve </button> <button class="btn btn-danger reject-result-btn" data-result-id="{{ result.id }}" data-matric-number="{{ result.enrollment.student.matric_number }}"> Quick Reject </button> </div> </div> {% endfor %} </div> {% empty %} <div class="ios-card"> <div style="text-align: center; padding: 60px; color: var(--text-secondary);"> <div style="width: 80px; height: 80px; background: var(--ios-green); opacity: 0.2; border-radius: 20px; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center;"> <div style="width: 40px; height: 40px; background: var(--ios-green); border-radius: 10px; opacity: 0.6;"></div> </div> <h3 style="color: var(--text-primary); margin-bottom: 8px;">No Pending Results</h3> <p>All results have been processed. Great work!</p> </div> </div> {% endfor %} </div> <script> function approveResult(resultId, matricNumber) { if (confirm(`Quick approve result for ${matricNumber}?`)) { fetch(`{% url "hod_approve_single_result" 0 %}`.replace('0', resultId), { method: 'POST', headers: { 'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value, 'Content-Type': 'application/x-www-form-urlencoded', } }) .then(response => response.json()) .then(data => { if (data.success) { alert(data.message); location.reload(); } else { alert('Error: ' + data.message); } }) .catch(error => { alert('An error occurred. Please try again.'); }); } } function rejectResult(resultId, matricNumber) { const reason = prompt(`Reject result for ${matricNumber}?\n\nPlease provide a reason:`); if (reason !== null && reason.trim() !== '') { // For rejection, redirect to the detailed review page with reject action window.location.href = `{% url "hod_review_single_result" 0 %}`.replace('0', resultId) + '?action=reject&reason=' + encodeURIComponent(reason); } } // Add event listeners for result action buttons document.addEventListener('DOMContentLoaded', function() { document.querySelectorAll('.approve-result-btn').forEach(button => { button.addEventListener('click', function() { const resultId = this.getAttribute('data-result-id'); const matricNumber = this.getAttribute('data-matric-number'); approveResult(resultId, matricNumber); }); }); document.querySelectorAll('.reject-result-btn').forEach(button => { button.addEventListener('click', function() { const resultId = this.getAttribute('data-result-id'); const matricNumber = this.getAttribute('data-matric-number'); rejectResult(resultId, matricNumber); }); }); }); </script> {% endblock %} 