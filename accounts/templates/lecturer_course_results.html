{% extends 'base.html' %} {% load role_tags %} {% block title %}{{ course.code }} Results - Lecturer{% endblock %} {% block content %} <div class="container-fluid"> <!-- Delegation Status Badges --> {% show_delegation_badges user %} <!-- Header --> <div class="row mb-4"> <div class="col-12"> <div class="card" style="background: var(--royal-blue-gradient); color: white;"> <div class="card-body"> <div class="row align-items-center"> <div class="col-md-8"> <h1 class="mb-1 fw-bold">{{ course.code }} - Results</h1> <p class="mb-0 opacity-75"> {{ course.title }} • {{ course.level.name }} • {{ course.session.name }} </p> </div> <div class="col-md-4 text-center"> <div style="background: rgba(255,255,255,0.2); padding: 12px 16px; border-radius: 12px;"> <div class="h3 fw-bold mb-0">{{ results_entered }}/{{ total_students }}</div> <small class="opacity-75">Results Entered</small> </div> </div> </div> </div> </div> </div> </div> <!-- Statistics --> <div class="row mb-4"> <div class="col-lg-3 col-md-6 mb-3"> <div class="card text-center h-100" style="border-left: 4px solid var(--ios-blue);"> <div class="card-body d-flex flex-column justify-content-center"> <div class="h2 fw-bold mb-2" style="color: var(--ios-blue);">{{ total_students }}</div> <div class="text-muted">Total Students</div> </div> </div> </div> <div class="col-lg-3 col-md-6 mb-3"> <div class="card text-center h-100" style="border-left: 4px solid var(--ios-green);"> <div class="card-body d-flex flex-column justify-content-center"> <div class="h2 fw-bold mb-2" style="color: var(--ios-green);">{{ results_entered }}</div> <div class="text-muted">Results Entered</div> </div> </div> </div> <div class="col-lg-3 col-md-6 mb-3"> <div class="card text-center h-100" style="border-left: 4px solid var(--ios-orange);"> <div class="card-body d-flex flex-column justify-content-center"> <div class="h2 fw-bold mb-2" style="color: var(--ios-orange);">{{ results_pending }}</div> <div class="text-muted">Pending Results</div> </div> </div> </div> <div class="col-lg-3 col-md-6 mb-3"> <div class="card text-center h-100" style="border-left: 4px solid var(--ios-red);"> <div class="card-body d-flex flex-column justify-content-center"> <div class="h2 fw-bold mb-2" style="color: var(--ios-red);"> {% if total_students > 0 %} {{ results_entered|floatformat:0 }}% {% else %} 0% {% endif %} </div> <div class="text-muted">Completion</div> </div> </div> </div> </div> <!-- Grade Distribution --> {% if grade_stats %} <div class="row mb-4"> <div class="col-12"> <div class="card"> <div class="card-header"> <h5 class="mb-0 fw-bold">Grade Distribution</h5> </div> <div class="card-body"> <div class="row"> {% for grade, count in grade_stats.items %} <div class="col-lg-2 col-md-4 col-6 mb-3 text-center"> <div class="card h-100"> <div class="card-body"> <div class="h3 fw-bold {% if grade == 'A' %}text-success {% elif grade == 'B' %}text-primary {% elif grade == 'C' %}text-info {% elif grade == 'D' %}text-warning {% else %}text-danger {% endif %}">{{ count }}</div> <div class="text-muted">Grade {{ grade }}</div> </div> </div> </div> {% endfor %} </div> </div> </div> </div> </div> {% endif %} <!-- Filter and Search --> <div class="row mb-4"> <div class="col-12"> <div class="card"> <div class="card-body"> <div class="row"> <div class="col-md-3 mb-2"> <select class="form-select form-select-sm" id="resultFilter"> <option value="">All Students</option> <option value="entered">Results Entered</option> <option value="pending">Results Pending</option> </select> </div> <div class="col-md-3 mb-2"> <select class="form-select form-select-sm" id="gradeFilter"> <option value="">All Grades</option> <option value="A">Grade A</option> <option value="B">Grade B</option> <option value="C">Grade C</option> <option value="D">Grade D</option> <option value="F">Grade F</option> </select> </div> <div class="col-md-6 mb-2"> <input type="text" class="form-control form-control-sm" placeholder="Search students..." id="searchInput"> </div> </div> </div> </div> </div> </div> <!-- Results List --> <div class="row"> <div class="col-12"> <div class="card"> <div class="card-header d-flex justify-content-between align-items-center"> <h5 class="mb-0 fw-bold">Course Results</h5> <div> <a href="{% url 'lecturer_enter_results' %}?course_id={{ course.id }}&session_id={{ course.session.id }}" class="btn btn-success btn-sm me-2"> <i class="bi bi-plus-circle me-1"></i>Enter Results </a> <a href="{% url 'lecturer_courses' %}" class="btn btn-outline-secondary btn-sm"> <i class="bi bi-arrow-left me-1"></i>Back to Courses </a> </div> </div> <div class="card-body"> {% if enrollments %} <!-- Desktop Table View --> <div class="d-none d-lg-block"> <div class="table-responsive"> <table class="table table-hover"> <thead class="table-light"> <tr> <th>Matric Number</th> <th>Student Name</th> <th>CA Score (30)</th> <th>Exam Score (70)</th> <th>Total (100)</th> <th>Grade</th> <th>Status</th> <th>Actions</th> </tr> </thead> <tbody> {% for enrollment in enrollments %} <tr class="result-row" data-result="{% if enrollment.result %}entered{% else %}pending{% endif %}" data-grade="{% if enrollment.result %}{{ enrollment.result.grade }}{% endif %}" data-search="{{ enrollment.student.matric_number|lower }} {{ enrollment.student.get_full_name|lower }}"> <td> <span class="fw-bold text-primary">{{ enrollment.student.matric_number }}</span> </td> <td> <div class="fw-bold">{{ enrollment.student.get_full_name }}</div> <small class="text-muted">{{ enrollment.student.user.email }}</small> </td> <td> {% if enrollment.result %} <span class="fw-bold">{{ enrollment.result.ca_score|default:'-' }}</span> {% else %} <span class="text-muted">-</span> {% endif %} </td> <td> {% if enrollment.result %} <span class="fw-bold">{{ enrollment.result.exam_score|default:'-' }}</span> {% else %} <span class="text-muted">-</span> {% endif %} </td> <td> {% if enrollment.result %} <span class="fw-bold">{{ enrollment.result.total_score|default:'-' }}</span> {% else %} <span class="text-muted">-</span> {% endif %} </td> <td> {% if enrollment.result %} <span class="badge {% if enrollment.result.grade == 'A' %}bg-success {% elif enrollment.result.grade == 'B' %}bg-primary {% elif enrollment.result.grade == 'C' %}bg-info {% elif enrollment.result.grade == 'D' %}bg-warning {% else %}bg-danger {% endif %}">{{ enrollment.result.grade }}</span> {% else %} <span class="badge bg-secondary">-</span> {% endif %} </td> <td> {% if enrollment.result %} <span class="badge bg-success">Entered</span> {% else %} <span class="badge bg-warning">Pending</span> {% endif %} </td> <td> <div class="btn-group btn-group-sm"> <a href="{% url 'lecturer_enter_results' %}?course_id={{ course.id }}&session_id={{ course.session.id }}" class="btn btn-outline-primary btn-sm"> <i class="bi bi-pencil"></i> </a> </div> </td> </tr> {% endfor %} </tbody> </table> </div> </div> <!-- Mobile Card View --> <div class="d-lg-none"> {% for enrollment in enrollments %} <div class="card mb-3 result-card" data-result="{% if enrollment.result %}entered{% else %}pending{% endif %}" data-grade="{% if enrollment.result %}{{ enrollment.result.grade }}{% endif %}" data-search="{{ enrollment.student.matric_number|lower }} {{ enrollment.student.get_full_name|lower }}"> <div class="card-body"> <div class="row"> <div class="col-12 mb-2"> <h6 class="card-title mb-1 text-primary fw-bold">{{ enrollment.student.matric_number }}</h6> <h5 class="mb-1">{{ enrollment.student.get_full_name }}</h5> <small class="text-muted">{{ enrollment.student.user.email }}</small> </div> </div> {% if enrollment.result %} <div class="row mb-3"> <div class="col-6 col-sm-3 mb-2"> <small class="text-muted d-block">CA Score</small> <span class="fw-bold">{{ enrollment.result.ca_score|default:'-' }}/30</span> </div> <div class="col-6 col-sm-3 mb-2"> <small class="text-muted d-block">Exam Score</small> <span class="fw-bold">{{ enrollment.result.exam_score|default:'-' }}/70</span> </div> <div class="col-6 col-sm-3 mb-2"> <small class="text-muted d-block">Total</small> <span class="fw-bold">{{ enrollment.result.total_score|default:'-' }}/100</span> </div> <div class="col-6 col-sm-3 mb-2"> <small class="text-muted d-block">Grade</small> <span class="badge {% if enrollment.result.grade == 'A' %}bg-success {% elif enrollment.result.grade == 'B' %}bg-primary {% elif enrollment.result.grade == 'C' %}bg-info {% elif enrollment.result.grade == 'D' %}bg-warning {% else %}bg-danger {% endif %}">{{ enrollment.result.grade }}</span> </div> </div> {% else %} <div class="alert alert-warning py-2 mb-3"> <small><i class="bi bi-exclamation-triangle me-1"></i>Results not entered yet</small> </div> {% endif %} <div class="row"> <div class="col-12"> <a href="{% url 'lecturer_enter_results' %}?course_id={{ course.id }}&session_id={{ course.session.id }}" class="btn btn-outline-primary btn-sm"> <i class="bi bi-pencil me-1"></i> {% if enrollment.result %}Edit Results{% else %}Enter Results{% endif %} </a> </div> </div> </div> </div> {% endfor %} </div> {% else %} <div class="text-center py-5"> <div class="mb-3"> <i class="bi bi-file-text display-1 text-muted"></i> </div> <h4 class="text-muted">No Students Enrolled</h4> <p class="text-muted">No students are enrolled in this course yet.</p> <a href="{% url 'lecturer_enroll_students' %}?course_id={{ course.id }}" class="btn btn-primary"> <i class="bi bi-person-plus me-1"></i>Enroll Students </a> </div> {% endif %} </div> </div> </div> </div> </div> <script> // Filter and search functionality document.addEventListener('DOMContentLoaded', function() { const resultFilter = document.getElementById('resultFilter'); const gradeFilter = document.getElementById('gradeFilter'); const searchInput = document.getElementById('searchInput'); const resultRows = document.querySelectorAll('.result-row'); const resultCards = document.querySelectorAll('.result-card'); function filterResults() { const resultValue = resultFilter.value; const gradeValue = gradeFilter.value; const searchValue = searchInput.value.toLowerCase(); // Filter table rows resultRows.forEach(row => { const rowResult = row.dataset.result; const rowGrade = row.dataset.grade; const rowSearch = row.dataset.search; const resultMatch = !resultValue || rowResult === resultValue; const gradeMatch = !gradeValue || rowGrade === gradeValue; const searchMatch = !searchValue || rowSearch.includes(searchValue); if (resultMatch && gradeMatch && searchMatch) { row.style.display = ''; } else { row.style.display = 'none'; } }); // Filter cards resultCards.forEach(card => { const cardResult = card.dataset.result; const cardGrade = card.dataset.grade; const cardSearch = card.dataset.search; const resultMatch = !resultValue || cardResult === resultValue; const gradeMatch = !gradeValue || cardGrade === gradeValue; const searchMatch = !searchValue || cardSearch.includes(searchValue); if (resultMatch && gradeMatch && searchMatch) { card.style.display = ''; } else { card.style.display = 'none'; } }); } resultFilter.addEventListener('change', filterResults); gradeFilter.addEventListener('change', filterResults); searchInput.addEventListener('input', filterResults); }); </script> {% endblock %} 