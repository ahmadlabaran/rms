{% extends 'base.html' %}

{% block title %}Students Management - RMS{% endblock %}

{% block content %}
<div style="max-width: 1200px; margin: 0 auto; padding: 32px 20px;">
    <!-- Header -->
    <div style="margin-bottom: 32px;">
        <h1 style="font-size: 32px; font-weight: 700; color: var(--text-primary); margin-bottom: 8px;">
            Students Management
        </h1>
        <p style="color: var(--text-secondary); font-size: 16px;">
            Manage student records, enrollments, and academic information
        </p>
    </div>

    <!-- Stats Cards -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px; margin-bottom: 32px;">
        <div class="ios-card" style="background: var(--royal-blue-gradient); color: white;">
            <div style="display: flex; align-items: center; justify-content: space-between;">
                <div>
                    <div style="font-size: 32px; font-weight: 700; margin-bottom: 4px;">{{ students.count }}</div>
                    <div style="font-size: 16px; opacity: 0.9;">Total Students</div>
                </div>
                <div style="font-size: 48px; opacity: 0.3;">
                    <i class="bi bi-people-fill"></i>
                </div>
            </div>
        </div>

        <div class="ios-card">
            <div style="display: flex; align-items: center; justify-content: space-between;">
                <div>
                    <div style="font-size: 32px; font-weight: 700; margin-bottom: 4px; color: var(--royal-blue);">{{ active_students }}</div>
                    <div style="font-size: 16px; color: var(--text-secondary);">Active Students</div>
                </div>
                <div style="font-size: 48px; opacity: 0.2; color: var(--royal-blue);">
                    <i class="bi bi-person-check-fill"></i>
                </div>
            </div>
        </div>

        <div class="ios-card">
            <div style="display: flex; align-items: center; justify-content: space-between;">
                <div>
                    <div style="font-size: 32px; font-weight: 700; margin-bottom: 4px; color: var(--accent-orange);">{{ new_students }}</div>
                    <div style="font-size: 16px; color: var(--text-secondary);">New This Session</div>
                </div>
                <div style="font-size: 48px; opacity: 0.2; color: var(--accent-orange);">
                    <i class="bi bi-person-plus-fill"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Search and Filters -->
    <div class="ios-card" style="margin-bottom: 32px;">
        <div style="display: flex; flex-wrap: wrap; gap: 16px; align-items: center; justify-content: space-between;">
            <div style="display: flex; gap: 16px; flex-wrap: wrap; flex: 1;">
                <input type="text" placeholder="Search students..." 
                       style="padding: 12px 16px; border: 1px solid var(--border-color); border-radius: 12px; font-size: 16px; min-width: 300px;">
                
                <select style="padding: 12px 16px; border: 1px solid var(--border-color); border-radius: 12px; font-size: 16px;">
                    <option value="">All Faculties</option>
                    {% for faculty in faculties %}
                    <option value="{{ faculty.id }}">{{ faculty.name }}</option>
                    {% endfor %}
                </select>

                <select style="padding: 12px 16px; border: 1px solid var(--border-color); border-radius: 12px; font-size: 16px;">
                    <option value="">All Levels</option>
                    <option value="100">100 Level</option>
                    <option value="200">200 Level</option>
                    <option value="300">300 Level</option>
                    <option value="400">400 Level</option>
                    <option value="500">500 Level</option>
                </select>
            </div>

            <div style="display: flex; gap: 12px;">
                <button style="background: var(--royal-blue); color: white; border: none; padding: 12px 20px; border-radius: 12px; font-weight: 600; cursor: pointer;">
                    <i class="bi bi-search me-2"></i>Search
                </button>
                <button style="background: var(--accent-green); color: white; border: none; padding: 12px 20px; border-radius: 12px; font-weight: 600; cursor: pointer;">
                    <i class="bi bi-person-plus me-2"></i>Add Student
                </button>
            </div>
        </div>
    </div>

    <!-- Students Table -->
    <div class="ios-card">
        <div style="overflow-x: auto;">
            <table style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr style="border-bottom: 2px solid var(--border-light);">
                        <th style="text-align: left; padding: 16px; font-weight: 600; color: var(--text-primary);">Student</th>
                        <th style="text-align: left; padding: 16px; font-weight: 600; color: var(--text-primary);">Matric Number</th>
                        <th style="text-align: left; padding: 16px; font-weight: 600; color: var(--text-primary);">Faculty</th>
                        <th style="text-align: left; padding: 16px; font-weight: 600; color: var(--text-primary);">Department</th>
                        <th style="text-align: left; padding: 16px; font-weight: 600; color: var(--text-primary);">Level</th>
                        <th style="text-align: left; padding: 16px; font-weight: 600; color: var(--text-primary);">Status</th>
                        <th style="text-align: center; padding: 16px; font-weight: 600; color: var(--text-primary);">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for student in students %}
                    <tr style="border-bottom: 1px solid var(--border-light);">
                        <td style="padding: 16px;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <div style="width: 40px; height: 40px; border-radius: 50%; background: var(--royal-blue-gradient); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600;">
                                    {{ student.user.first_name|first }}{{ student.user.last_name|first }}
                                </div>
                                <div>
                                    <div style="font-weight: 600; color: var(--text-primary);">{{ student.user.first_name }} {{ student.user.last_name }}</div>
                                    <div style="font-size: 14px; color: var(--text-secondary);">{{ student.user.email }}</div>
                                </div>
                            </div>
                        </td>
                        <td style="padding: 16px; font-weight: 600; color: var(--royal-blue);">{{ student.matric_number }}</td>
                        <td style="padding: 16px; color: var(--text-secondary);">{{ student.faculty.name|default:"Not Assigned" }}</td>
                        <td style="padding: 16px; color: var(--text-secondary);">{{ student.department.name|default:"Not Assigned" }}</td>
                        <td style="padding: 16px;">
                            <span style="background: var(--royal-blue-ultra-light); color: var(--royal-blue); padding: 4px 12px; border-radius: 20px; font-size: 14px; font-weight: 600;">
                                {{ student.current_level.name|default:"Not Set" }}
                            </span>
                        </td>
                        <td style="padding: 16px;">
                            {% if student.is_active %}
                            <span style="background: var(--accent-green-light); color: var(--accent-green); padding: 4px 12px; border-radius: 20px; font-size: 14px; font-weight: 600;">
                                Active
                            </span>
                            {% else %}
                            <span style="background: var(--accent-red-light); color: var(--accent-red); padding: 4px 12px; border-radius: 20px; font-size: 14px; font-weight: 600;">
                                Inactive
                            </span>
                            {% endif %}
                        </td>
                        <td style="padding: 16px; text-align: center;">
                            <div style="display: flex; gap: 8px; justify-content: center;">
                                <button style="background: var(--royal-blue-ultra-light); color: var(--royal-blue); border: none; padding: 8px 12px; border-radius: 8px; cursor: pointer;" title="View Details">
                                    <i class="bi bi-eye"></i>
                                </button>
                                <button style="background: var(--accent-orange-light); color: var(--accent-orange); border: none; padding: 8px 12px; border-radius: 8px; cursor: pointer;" title="Edit">
                                    <i class="bi bi-pencil"></i>
                                </button>
                                <button style="background: var(--accent-red-light); color: var(--accent-red); border: none; padding: 8px 12px; border-radius: 8px; cursor: pointer;" title="Delete">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="7" style="padding: 40px; text-align: center; color: var(--text-secondary);">
                            <div style="font-size: 48px; margin-bottom: 16px; opacity: 0.3;">
                                <i class="bi bi-people"></i>
                            </div>
                            <div style="font-size: 18px; font-weight: 600; margin-bottom: 8px;">No Students Found</div>
                            <div style="font-size: 14px;">Start by adding your first student to the system.</div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Pagination -->
    {% if students.has_other_pages %}
    <div style="display: flex; justify-content: center; margin-top: 32px;">
        <div style="display: flex; gap: 8px; align-items: center;">
            {% if students.has_previous %}
            <a href="?page={{ students.previous_page_number }}" style="padding: 8px 12px; border: 1px solid var(--border-color); border-radius: 8px; text-decoration: none; color: var(--text-primary);">
                <i class="bi bi-chevron-left"></i>
            </a>
            {% endif %}
            
            <span style="padding: 8px 16px; color: var(--text-secondary);">
                Page {{ students.number }} of {{ students.paginator.num_pages }}
            </span>
            
            {% if students.has_next %}
            <a href="?page={{ students.next_page_number }}" style="padding: 8px 12px; border: 1px solid var(--border-color); border-radius: 8px; text-decoration: none; color: var(--text-primary);">
                <i class="bi bi-chevron-right"></i>
            </a>
            {% endif %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
